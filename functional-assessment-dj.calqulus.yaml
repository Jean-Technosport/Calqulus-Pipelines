############
## SPACES ##
############

- space: VirtualLab
  alignWithSegment:
    segment: Hips

############
## EVENTS ##
############

- event: BOF
  steps:
    - import: [1]

- event: EOF
  steps:
    - import: [$length]

- parameter: RPV_CGVel
  steps:
    - segment: Hips
      space: VirtualLab
    - velocity:
    - convert: $prev
      from: mm/s
      to: m/s

# Bilateral and left
- event: TakeOff_L
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - max: RPV_CGVel.z
      frames: true
    - add: [$prev, 3]

- event: TouchDown_L
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - eventMask: [RPV_CGVel.z,BOF, TakeOff_L]
    - min:
      frames: true
    - subtract: [$prev, 4]

- event: Landing_L
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - eventMask: [RPV_CGVel.z,TakeOff_L, EOF]
    - min:
      frames: true
    - subtract: [$prev, 4]

- event: TakeOff
  where:
    name: DJ_[LB]*
  steps:
    - import: TakeOff_L

- event: TouchDown
  where:
    name: DJ_[LB]*
  steps:
    - import: TouchDown_L

- event: Landing
  where:
    name: DJ_[LB]*
  steps:
    - import: Landing_L

# Following events are needed for compatibility with force data event detection
- event: LON
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - import: TouchDown_L

- event: LOFF
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - import: TakeOff_L

- event: LON
  where:
    name: DJ_[LB]*
  set: left
  steps:
    - import: Landing_L

# Bilateral and right
- event: TakeOff_R
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - max: RPV_CGVel.z
      frames: true
    - add: [$prev, 3]

- event: TouchDown_R
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - eventMask: [RPV_CGVel.z,BOF, TakeOff_R]
    - min:
      frames: true
    - subtract: [$prev, 4]

- event: Landing_R
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - eventMask: [RPV_CGVel.z,TakeOff_R, EOF]
    - min:
      frames: true
    - subtract: [$prev, 4]

- event: TakeOff
  where:
    name: DJ_[RB]*
  steps:
    - import: TakeOff_R

- event: TouchDown
  where:
    name: DJ_[RB]*
  steps:
    - import: TouchDown_R

- event: Landing
  where:
    name: DJ_[RB]*
  steps:
    - import: Landing_R

# Following events are needed for compatibility with force data event detection
- event: RON
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - import: TouchDown_R

- event: ROFF
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - import: TakeOff_R

- event: RON
  where:
    name: DJ_[RB]*
  set: right
  steps:
    - import: Landing_R

- event: Pelvis_lowest
  steps:
    - import: Hips.z
    - eventMask: [$prev, TouchDown, TakeOff]
    - min:
      frames: true

- event: COM_MIN # we do not have body COM so we use pelvis COM instead
  steps:
    - import: Hips.z
    - eventMask: [$prev, TouchDown, TakeOff]
    - min:
      frames: true

# Landing end 
# Place Landing_end at EOF if Landing_end cannot be created because there is no descending zero crossing of PelvisCGPos_vel after landing.
- event: Landing_end_temp
  steps:
    - threshold: RPV_CGVel.z
      value: 0
      direction: down
    - eventMask: [$prev, Landing, EOF]
      keep: 1
      # frames: true

- event: EOF-1
  steps:
    - import: EOF
      frames: true
    - subtract: [$length,2]

- event: Landing_end
  steps:
    - if: Landing_end_temp
      then: Landing_end_temp
      else: EOF-1

# unified event names for web
- event: LeftPlotStart
  where:
    name: DJ_[LB]*
  steps:
    - import: TouchDown_L

- event: RightPlotStart
  where:
    name: DJ_[RB]*
  steps:
    - import: TouchDown_R

- event: LeftPlotEnd
  where:
    name: DJ_[LB]*
  steps:
    - import: TakeOff_L

- event: RightPlotEnd
  where:
    name: DJ_[RB]*
  steps:
    - import: TakeOff_R

############
## SERIES ##
############

# --- Pelvis ---

- parameter: Left Pelvic Angles
  set: left
  steps:
    - jointAngle: Hips
      space: VirtualLab
    - multiply: [$prev, [-1, 1, -1]]

- parameter: Right Pelvic Angles
  set: right
  steps:
    - jointAngle: Hips
      space: VirtualLab
    - multiply: [$prev, [-1, -1, 1]]

# --- Hips ---

- parameter: Left Hip Angles
  set: left
  steps:
    - jointAngle: [Hips, LeftUpLeg]
    - multiply: [$prev, [1, -1, -1]]

- parameter: Right Hip Angles
  set: right
  steps:
    - jointAngle: [Hips, RightUpLeg]
    - multiply: [$prev, [1, 1, -1]]

# --- Knee ---

- parameter: Left Knee Angles
  set: left
  steps:
    - jointAngle: [LeftUpLeg, LeftLeg]
    - multiply: [$prev, [-1, -1, -1]]

- parameter: Right Knee Angles
  set: right
  steps:
    - jointAngle: [RightUpLeg, RightLeg]
    - multiply: [$prev, [-1, 1, 1]]

# --- Ankle ---

- parameter: Left Ankle Angles
  set: left
  steps:
    - jointAngle: [LeftLeg, LeftFoot]
    - multiply: [$prev, [1, -1, 1]]

- parameter: Right Ankle Angles
  set: right
  steps:
    - jointAngle: [RightLeg, RightFoot]
    - multiply: [$prev, [1, 1, -1]]

- parameter: Left Foot Progression
  set: left
  steps:
    - jointAngle: LeftFoot
      space: VirtualLab
    - multiply: [$prev, [1, 1, -1]]

- parameter: Right Foot Progression
  set: right
  steps:
    - jointAngle: RightFoot
      space: VirtualLab
    - multiply: [$prev, [1, 1, 1]]

- parameter: Left Foot Pitch Angles
  set: left
  steps:
    - jointAngle: LeftFoot
      space: VirtualLab
    - multiply: [$prev, [1, 1, -1]]

- parameter: Right Foot Pitch Angles
  set: right
  steps:
    - jointAngle: RightFoot
      space: VirtualLab
    - multiply: [$prev, [1, 1, 1]]

# --- Upper body ---

- parameter: Left Thorax_Lab Angles
  set: left
  steps:
    - jointAngle: Spine2
      space: VirtualLab
    - multiply: [$prev, [-1,1,-1]]

- parameter: Right Thorax_Lab Angles
  set: right
  steps:
    - jointAngle: Spine2
      space: VirtualLab
    - multiply: [$prev, [-1,-1,1]]

- parameter: Left Thorax Angles
  set: left
  steps:
    - jointAngle: [Hips, Spine2]
    - multiply: [$prev, [-1, 1, -1]]

- parameter: Right Thorax Angles
  set: right
  steps:
    - jointAngle: [Hips, Spine2]
    - multiply: [$prev, [-1, -1, 1]]

- parameter: Left Shoulder Angles
  set: left
  steps:
    - angle: [Spine2, LeftArm]
      rotationOrder: ZYZ
    - multiply: [$prev, [-1, -1, 1]]

- parameter: Right Shoulder Angles
  set: right
  steps:
    - angle: [Spine2, RightArm]
      rotationOrder: ZYZ
    - multiply: [$prev, [1, 1, -1]]

# --- Arms ---

- parameter: Left Elbow Angles
  set: left
  steps:
    - angle: [LeftArm, LeftForearm]
    - multiply: [$prev, [1, 1, -1]]

- parameter: Right Elbow Angles
  set: right
  steps:
    - angle: [RightArm, RightForearm]
    - multiply: [$prev, [1, 1, 1]]

# COM distance to knee and ankle
# for now using pelvis COM instead of body COM
- parameter: Left_Knee_COM_distance
  set: left
  steps:
    - segment: LeftLeg => knee
      space: VirtualLab
    - segment: Hips => pelvis
      space: VirtualLab
    - subtract: [pelvis, knee]
    - convert: 
      from: mm
      to: m

- parameter: Right_Knee_COM_distance
  set: right
  steps:
    - segment: RightLeg => knee
      space: VirtualLab
    - segment: Hips => pelvis
      space: VirtualLab
    - subtract: [pelvis, knee]
    - convert: 
      from: mm
      to: m
    - multiply: [$prev,[-1,1,1]] #Invert right signal to make lateral movement positive

- parameter: Left_Ankle_COM_distance
  set: left
  steps:
    - segment: LeftFoot => foot
      space: VirtualLab
    - segment: Hips => pelvis
      space: VirtualLab
    - subtract: [pelvis, foot]
    - convert: 
      from: mm
      to: m

- parameter: Right_Ankle_COM_distance
  set: right
  steps:
    - segment: RightFoot => foot
      space: VirtualLab
    - segment: Hips => pelvis
      space: VirtualLab
    - subtract: [pelvis, foot]
    - convert: 
      from: mm
      to: m
    - multiply: [$prev,[-1,1,1]] #Invert right signal to make lateral movement positive

#############
## Metrics ##
#############

# Contact time
- parameter: ContactTime_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventDuration: [TouchDown,TakeOff]

- parameter: ContactTime_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventDuration: [TouchDown,TakeOff]

- parameter: ContactTime_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventDuration: [TouchDown,TakeOff]

# Flight Time
- parameter: FlightTime_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventDuration: [TakeOff,Landing]

- parameter: FlightTime_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventDuration: [TakeOff,Landing]

- parameter: FlightTime_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventDuration: [TakeOff,Landing]

# Eccentric time
- parameter: EccentricTime_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventDuration: [TouchDown,COM_MIN]

- parameter: EccentricTime_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventDuration: [TouchDown,COM_MIN]

- parameter: EccentricTime_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventDuration: [TouchDown,COM_MIN]

# Concentric time
- parameter: ConcentricTime_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventDuration: [COM_MIN,TakeOff]

- parameter: ConcentricTime_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventDuration: [COM_MIN,TakeOff]

- parameter: ConcentricTime_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventDuration: [COM_MIN,TakeOff]

# Flight time to Contraction time ratio
- parameter: Flight_Contraction_time_ratio_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [FlightTime_DVJ_B,EccentricTime_DVJ_B]

- parameter: Flight_Contraction_time_ratio_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [FlightTime_DVJ_L,EccentricTime_DVJ_L]

- parameter: Flight_Contraction_time_ratio_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [FlightTime_DVJ_R,EccentricTime_DVJ_R]

# COM @TakeOff, max, min
# We use Pelvis COM for now
- parameter: COM_Z_TO_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Hips@TakeOff
    - convert:
      from: mm
      to: m

- parameter: COM_Z_TO_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Hips@TakeOff
    - convert:
      from: mm
      to: m

- parameter: COM_Z_TO_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Hips@TakeOff
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MAX_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Hips
    - eventMask: [$prev,TakeOff,TouchDown]
    - max:
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MAX_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Hips
    - eventMask: [$prev,TakeOff,TouchDown]
    - max:
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MAX_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Hips
    - eventMask: [$prev,TakeOff,TouchDown]
    - max:
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - min: Hips.z
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - min: Hips.z
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - min: Hips.z
    - convert:
      from: mm
      to: m

- parameter: CenterOfMass@Landing_end
  steps:
    - import: Hips@Landing_end
    - convert:
      from: mm
      to: m

#debugging signal, can be removed
- parameter: Pelvis_COM
  steps:
    - import: Hips
    - convert:
      from: mm
      to: m

# Jump height calculated from pelvis height
# other options ('takeoff_velocity', 'flight_time', 'static_trial') are not available, yet

- parameter: COM_displacement_MEAN_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Hips.z@TakeOff => PelvisCGPos@TakeOff
    - eventMask: [Hips.z,TakeOff,Landing]
    - max: $prev
    - subtract: [$prev,$prev(3)]
    - convert:
      from: mm
      to: m

- parameter: COM_displacement_MEAN_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Hips.z@TakeOff => PelvisCGPos@TakeOff
    - eventMask: [Hips.z,TakeOff,Landing]
    - max: $prev
    - subtract: [$prev,$prev(3)]
    - convert:
      from: mm
      to: m

- parameter: COM_displacement_MEAN_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Hips.z@TakeOff => PelvisCGPos@TakeOff
    - eventMask: [Hips.z,TakeOff,Landing]
    - max: $prev
    - subtract: [$prev,$prev(3)]
    - convert:
      from: mm
      to: m

- parameter: COM_displacement_MEAN_min_DVJ_B
  where:
    name: DJ_B*
  steps:
    - subtract: [CenterOfMass\@Landing_end, CenterOfMass_MIN_DVJ_B]

- parameter: COM_displacement_MEAN_min_DVJ_L
  where:
    name: DJ_L*
  steps:
    - subtract: [CenterOfMass\@Landing_end, CenterOfMass_MIN_DVJ_L]

- parameter: COM_displacement_MEAN_min_DVJ_R
  where:
    name: DJ_R*
  steps:
    - subtract: [CenterOfMass\@Landing_end, CenterOfMass_MIN_DVJ_R]

#COM peak eccentric velocity
- parameter: PelvisCGPos_vel_min_eccentric_DVJ_B
  where:
    name: DJ_B*
  steps:
    - min: RPV_CGVel
    - eventMask: [$prev,TouchDown,COM_MIN]

- parameter: PelvisCGPos_vel_min_eccentric_DVJ_L
  where:
    name: DJ_L*
  steps:
    - min: RPV_CGVel
    - eventMask: [$prev,TouchDown,COM_MIN]

- parameter: PelvisCGPos_vel_min_eccentric_DVJ_R
  where:
    name: DJ_R*
  steps:
    - min: RPV_CGVel
    - eventMask: [$prev,TouchDown,COM_MIN]

#Jump Height to Flight Time Ratio
- parameter: Jump_height_flight_time_ratio_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_B,FlightTime_DVJ_B]

- parameter: Jump_height_flight_time_ratio_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_L,FlightTime_DVJ_L]

- parameter: Jump_height_flight_time_ratio_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_R,FlightTime_DVJ_R]

# Jump height to Contact Time Ratio
- parameter: Jump_height_contact_time_ratio_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_B, ContactTime_DVJ_B]

- parameter: Jump_height_contact_time_ratio_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_L, ContactTime_DVJ_L]

- parameter: Jump_height_contact_time_ratio_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_R, ContactTime_DVJ_R]

# Flight time to Contraction time ratio
- parameter: Flight_Contraction_time_ratio_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [FlightTime_DVJ_B, EccentricTime_DVJ_B]

- parameter: Flight_Contraction_time_ratio_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [FlightTime_DVJ_L, EccentricTime_DVJ_L]

- parameter: Flight_Contraction_time_ratio_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [FlightTime_DVJ_R, EccentricTime_DVJ_R]

# Reactive strength index
- parameter: Reactive_strength_index_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [FlightTime_DVJ_B, ContactTime_DVJ_B]

- parameter: Reactive_strength_index_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [FlightTime_DVJ_L, ContactTime_DVJ_L]

- parameter: Reactive_strength_index_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [FlightTime_DVJ_R, ContactTime_DVJ_R]

# Modified reactive strength index
- parameter: Reactive_strength_index_modified_DVJ_B
  where:
    name: DJ_B*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_B, ContactTime_DVJ_B]

- parameter: Reactive_strength_index_modified_DVJ_L
  where:
    name: DJ_L*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_L, ContactTime_DVJ_L]

- parameter: Reactive_strength_index_modified_DVJ_R
  where:
    name: DJ_R*
  steps:
    - divide: [COM_displacement_MEAN_max_DVJ_R, ContactTime_DVJ_R]

# COM-COP distance
# to do



# COM distance to knee and ankle
# @TouchDown
- parameter: Left_Knee_COM_distance@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Knee_COM_distance@TouchDown

- parameter: Right_Knee_COM_distance@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Knee_COM_distance@TouchDown

- parameter: Left_Ankle_COM_distance@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Ankle_COM_distance@TouchDown

- parameter: Right_Ankle_COM_distance@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Ankle_COM_distance@TouchDown

- parameter: Left_Knee_COM_distance@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Knee_COM_distance@TouchDown

- parameter: Right_Knee_COM_distance@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Knee_COM_distance@TouchDown

- parameter: Left_Ankle_COM_distance@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Ankle_COM_distance@TouchDown

- parameter: Right_Ankle_COM_distance@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Ankle_COM_distance@TouchDown

- parameter: Left_Knee_COM_distance@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Knee_COM_distance@TouchDown

- parameter: Right_Knee_COM_distance@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Knee_COM_distance@TouchDown

- parameter: Left_Ankle_COM_distance@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Ankle_COM_distance@TouchDown

- parameter: Right_Ankle_COM_distance@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Ankle_COM_distance@TouchDown

# @TakeOff
- parameter: Left_Knee_COM_distance@TakeOff_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Knee_COM_distance@TakeOff

- parameter: Right_Knee_COM_distance@TakeOff_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Knee_COM_distance@TakeOff

- parameter: Left_Ankle_COM_distance@TakeOff_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Ankle_COM_distance@TakeOff

- parameter: Right_Ankle_COM_distance@TakeOff_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Ankle_COM_distance@TakeOff

- parameter: Left_Knee_COM_distance@TakeOff_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Knee_COM_distance@TakeOff

- parameter: Right_Knee_COM_distance@TakeOff_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Knee_COM_distance@TakeOff

- parameter: Left_Ankle_COM_distance@TakeOff_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Ankle_COM_distance@TakeOff

- parameter: Right_Ankle_COM_distance@TakeOff_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Ankle_COM_distance@TakeOff

- parameter: Left_Knee_COM_distance@TakeOff_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Knee_COM_distance@TakeOff

- parameter: Right_Knee_COM_distance@TakeOff_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Knee_COM_distance@TakeOff

- parameter: Left_Ankle_COM_distance@TakeOff_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Ankle_COM_distance@TakeOff

- parameter: Right_Ankle_COM_distance@TakeOff_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Ankle_COM_distance@TakeOff

# @Pelvis_lowest
- parameter: Left_Knee_COM_distance@Pelvis_lowest_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Knee_COM_distance@Pelvis_lowest

- parameter: Right_Knee_COM_distance@Pelvis_lowest_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Knee_COM_distance@Pelvis_lowest

- parameter: Left_Ankle_COM_distance@Pelvis_lowest_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left_Ankle_COM_distance@Pelvis_lowest

- parameter: Right_Ankle_COM_distance@Pelvis_lowest_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right_Ankle_COM_distance@Pelvis_lowest

- parameter: Left_Knee_COM_distance@Pelvis_lowest_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Knee_COM_distance@Pelvis_lowest

- parameter: Right_Knee_COM_distance@Pelvis_lowest_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Knee_COM_distance@Pelvis_lowest

- parameter: Left_Ankle_COM_distance@Pelvis_lowest_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left_Ankle_COM_distance@Pelvis_lowest

- parameter: Right_Ankle_COM_distance@Pelvis_lowest_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right_Ankle_COM_distance@Pelvis_lowest

- parameter: Left_Knee_COM_distance@Pelvis_lowest_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Knee_COM_distance@Pelvis_lowest

- parameter: Right_Knee_COM_distance@Pelvis_lowest_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Knee_COM_distance@Pelvis_lowest

- parameter: Left_Ankle_COM_distance@Pelvis_lowest_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left_Ankle_COM_distance@Pelvis_lowest

- parameter: Right_Ankle_COM_distance@Pelvis_lowest_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right_Ankle_COM_distance@Pelvis_lowest

# Other metrics @TouchDown
- parameter: Left Knee Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Knee Angles@TouchDown

- parameter: Right Knee Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Knee Angles@TouchDown

- parameter: Left Hip Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Hip Angles@TouchDown

- parameter: Right Hip Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Hip Angles@TouchDown

- parameter: Left Thorax Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Thorax Angles@TouchDown

- parameter: Right Thorax Angles@TouchDown_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Thorax Angles@TouchDown

- parameter: Left Knee Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Knee Angles@TouchDown

- parameter: Right Knee Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Knee Angles@TouchDown

- parameter: Left Hip Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Hip Angles@TouchDown

- parameter: Right Hip Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Hip Angles@TouchDown

- parameter: Left Thorax Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Thorax Angles@TouchDown

- parameter: Right Thorax Angles@TouchDown_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Thorax Angles@TouchDown

- parameter: Left Knee Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Knee Angles@TouchDown

- parameter: Right Knee Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Knee Angles@TouchDown

- parameter: Left Hip Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Hip Angles@TouchDown

- parameter: Right Hip Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Hip Angles@TouchDown

- parameter: Left Thorax Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Thorax Angles@TouchDown

- parameter: Right Thorax Angles@TouchDown_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Thorax Angles@TouchDown

# @COM_MIN
- parameter: Left Ankle Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Ankle Angles@COM_MIN

- parameter: Right Ankle Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Ankle Angles@COM_MIN

- parameter: Left Knee Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Knee Angles@COM_MIN

- parameter: Right Knee Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Knee Angles@COM_MIN

- parameter: Left Hip Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Hip Angles@COM_MIN

- parameter: Right Hip Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Hip Angles@COM_MIN

- parameter: Left Thorax Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Left Thorax Angles@COM_MIN

- parameter: Right Thorax Angles@COM_MIN_DVJ_B
  where:
    name: DJ_B*
  steps:
    - import: Right Thorax Angles@COM_MIN

- parameter: Left Ankle Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Ankle Angles@COM_MIN

- parameter: Right Ankle Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Ankle Angles@COM_MIN

- parameter: Left Knee Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Knee Angles@COM_MIN

- parameter: Right Knee Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Knee Angles@COM_MIN

- parameter: Left Hip Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Hip Angles@COM_MIN

- parameter: Right Hip Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Hip Angles@COM_MIN

- parameter: Left Thorax Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Left Thorax Angles@COM_MIN

- parameter: Right Thorax Angles@COM_MIN_DVJ_L
  where:
    name: DJ_L*
  steps:
    - import: Right Thorax Angles@COM_MIN

- parameter: Left Ankle Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Ankle Angles@COM_MIN

- parameter: Right Ankle Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Ankle Angles@COM_MIN

- parameter: Left Knee Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Knee Angles@COM_MIN

- parameter: Right Knee Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Knee Angles@COM_MIN

- parameter: Left Hip Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Hip Angles@COM_MIN

- parameter: Right Hip Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Hip Angles@COM_MIN

- parameter: Left Thorax Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Left Thorax Angles@COM_MIN

- parameter: Right Thorax Angles@COM_MIN_DVJ_R
  where:
    name: DJ_R*
  steps:
    - import: Right Thorax Angles@COM_MIN

#Maximum during takeoff
- parameter: Left Hip Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Left Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Hip Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Right Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Knee Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Left Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Knee Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Right Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Ankle Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Left Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Ankle Angles_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Right Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Foot Progression_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Left Foot Progression, TouchDown,TakeOff]
    - max:

- parameter: Right Foot Progression_max_DVJ_B
  where:
    name: DJ_B*
  steps:
    - eventMask: [Right Foot Progression, TouchDown,TakeOff]
    - max:

- parameter: Left Hip Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Left Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Hip Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Right Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Knee Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Left Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Knee Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Right Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Ankle Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Left Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Ankle Angles_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Right Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Foot Progression_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Left Foot Progression, TouchDown,TakeOff]
    - max:

- parameter: Right Foot Progression_max_DVJ_L
  where:
    name: DJ_L*
  steps:
    - eventMask: [Right Foot Progression, TouchDown,TakeOff]
    - max:

- parameter: Left Hip Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Left Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Hip Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Right Hip Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Knee Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Left Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Knee Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Right Knee Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Ankle Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Left Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Right Ankle Angles_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Right Ankle Angles, TouchDown,TakeOff]
    - max:

- parameter: Left Foot Progression_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Left Foot Progression, TouchDown,TakeOff]
    - max:

- parameter: Right Foot Progression_max_DVJ_R
  where:
    name: DJ_R*
  steps:
    - eventMask: [Right Foot Progression, TouchDown,TakeOff]
    - max:
